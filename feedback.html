<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/partials/feedback.css">
    <title></title>
</head>
<body>
    <div class="menu" id="menu">
        <span id="bemVindo">Bem vindo,<span id="menuUser"></span></span>
        <button type="button" id="bntPerfil">Meu Perfil</button>
    </div>
    <br>

    <!-- Informações dos estagiários -->

    <div class="overlay" id="overlay" aria-hidden="true" role="dialog">
            <div class="profile-card" role="document" aria-labelledby="profileName">
                <div class="profile-top">
                    <button class="back-btn" id="backBtn" aria-label="Voltar">← Voltar</button>
                    <h2 id="profilName" class="profile-name">Samuel</h2>
                </div>
            </div>

            <div class="profile-info">
                    <div class="info">
                        <p>Pontos: <span id="points"></span></p><br>
                    </div>
                    <!-- Área dos Feedbacks recebidos -->
                    <div class="feedbacklist">
                        <p class="feedbacks">Feeedbacks Recebidos:</p><br>
                        <textarea name="message" id="textarea"></textarea>
                    </div>
                    <br>
                    <div class="btnEnviar">
                        <button class="btn-enviar" id="btnEnviar">Enviar Feedback</button>
                    </div>

                </div>
            </div>

            <!-- Script -->

            <script>
                const backBtn = document.getElementById("backBtn");
                const btnEnviar = document.getElementById("btnEnviar");
                const textarea = document.getElementById("textarea");

            // Botão voltar
                backBtn.addEventListener('click', () => {
                window.location.href = 'monitor.html';
            });

            // Botão enviar feedback
            btnEnviar.addEventListener('click', () => {
            const feedback = textarea.value.trim();
                if(feedback === "") {
                    alert("Digite algum feedback antes de enviar!");
                    return;
             }


            // Armazena o Feedback
            let samuelFeedbacks = JSON.parse(localStorage.getItem('samuelFeedbacks')) || [];
            samuelFeedbacks.push(feedback);
            localStorage.setItem('samuelFeedbacks', JSON.stringify(samuelFeedbacks));

            // Atualiza os pontos
            let storedPoints = localStorage.getItem('samuelPoints');
            let samuelPoints = storedPoints ? Number(storedPoints) : 0;

            if (isNaN(samuelPoints)) {
                samuelPoints = 0; 
            }

            samuelPoints +=1;
            localStorage.setItem('samuelPoints', samuelPoints);

            textarea.value = '';
            

            alert('Feedback enviado com sucesso!');
            });

            window.addEventListener('DOMContentLoaded', () => {
            const pointsEl = document.getElementById('points');
            const storedPoints = Number(localStorage.getItem('samuelPoints')) || 0;
            pointsEl.textContent = storedPoints;
            });

        </script>
</body>
</html>